## 웹 애플리케이션

### 웹 서버(Web Server)

* HTTP 기반으로 동작
* 정적 리소스 제공, 기타 부가기능
* 정적(파일) HTML, CSS, JS, 이미지, 영상
* 예) NGINX, APACHE

### 웹 애플리케이션 서버(WAS - Web Application Server)

* 웹 서버 기능 + 애플리케이션 로직 수행
* 동적 HTML, HTTP API(JSON)
* 서블릿, JSP, 스프링 MVC
* 예) 톰캣(Tomcat) Jetty, Undertow

자바는 서블릿 컨테이너 기능을 제공하면 WAS

### 서블릿

HTTP 요청시

* WAS는 Request, Response 객체를 새로 만들어서 서블릿 객체 호출
* 개발자는 Request 객체에서 HTTP 요청 정보를 편리하게 꺼내서 사용
* 개발자는 Response 객체에 HTTP 응답 정보를 편리하게 입력
* WAS는 Response 객체에 담겨있는 내용으로 HTTP 응답 정보를 생성

#### 서블릿 컨테이너

* 톰캣처럼 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 함
* 서블릿 컨테이너는 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명주기 관리
* 서블릿 객체는 싱글톤으로 관리
* JSP도 서블릿으로 변환 되어서 사용
* 동시 요청을 위한 멀티 쓰레드 처리 지원

### 멀티 쓰레드

요청 마다 쓰레드 생성

* 장점
  * 동시 요청을 처리할 수 있다.
  * 리소스가 허용할 때 까지 처리 가능
  * 하나의 쓰레드가 지연 되어도, 나머지 쓰레드는 정상 동작한다.
* 단점
  * 쓰레드는 생성 비용이 매우 비싸다.
    * 고객 요청이 올 때마다 쓰레드를 생성하면, 응답 속도가 늦어진다.
  * 쓰레드는 컨텍스트 스위칭 비용이 발생한다.
  * 쓰레드 생성에 제한이 없다.
    * 고객 요청이 너무 많이 오면, CPU, 메모리 임계점을 넘어서 서버가 죽을 수 있다.

#### 쓰레드 풀

* 필요한 쓰레드를 쓰레드 풀에 보관하고 관리
* 쓰레드 풀에 생성 가능한 쓰레드의 최대치를 관리한다. 톰캣은 최대 200개 기본 설정
* 쓰레드가 필요하면, 이미 생성되어 있는 쓰레드를 쓰레드 풀에서 꺼내서 사용
* 사용 종료하면 쓰레드 반납
* 쓰레드가 모두 사용중이면 기다리는 요청은 거절하거나 특정 숫자만큼만 대기하도록 설정 가능

장점

* 쓰레드를 생성하고 종료하는 비용이 절약되고, 응답 시간이 빠름
* 생성 가능한 쓰레드의 최대치가 있으므로 너무 많은 요청이 들어와도 기존 요청은 안전하게 처리 가능

#### WAS의 멀티 쓰레드 지원

* 멀티 쓰레드에 대한 부분은 WAS가 처리
* 개발자는 마치 싱글 쓰레드 프로그래밍을 하듯이 편리하게 소스 코드 개발
* 멀티 쓰레드 환경이므로 싱글톤 객체는 주의해서 사용

### SSR, CSR

#### SSR - 서버 사이드 렌더링

* HTML 최종 결과를 서버에서 만들어서 웹 브라우저에 전달
* 주로 정적인 화면에 사용
* 관련기술: JSP, 타임리프

#### CSR - 클라이언트 사이드 렌더링

* HTML 결과를 자바스크립트를 사용해 웹 브라우저에서 동적으로 생성해서 적용
* 주로 동적인 화면에 사용
* 관련기술: React, Vue.js

### 자바 뷰 템플릿

* JSP
  * 속도 느림, 기능 부족
* Freemarker, Velocity
  * 속도 문제 해결, 다양한 기능
* Thymeleaf
  * 내추럴 템플릿: HTML의 모양을 유지하면서 뷰 템플릿 적용 가능
  * 스프링 MVC와 강력한 기능 통합
  * 성능은 프리마커, 벨로시티가 더 빠름